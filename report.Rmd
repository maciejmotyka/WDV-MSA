---
title: "WDV MSA"
author: "Maciej Motyka"
date: "4/8/2020"
output: 
  html_document:
    toc: true
    toc_float: true
    toc_depth: 2
    code_folding: "hide"
    # theme: darkly
    #css: styles.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE)
```

# aBayesQR trees

```{r fig.height=10, fig.width=15}
drake::loadd(c("abqr001_Muscle_dml_upgma", "abqr001_ClustalO_dml_upgma", "abqr001_ClustalW_dml_upgma"))
par(mfrow = c(1,3))
ape::plot.phylo(abqr001_Muscle_dml_upgma, main = "Muscle -> dist.ml -> upgma", use.edge.length = FALSE, cex = 1)
ape::plot.phylo(abqr001_ClustalO_dml_upgma, main = "ClustalO -> dist.ml -> upgma", use.edge.length = FALSE, cex = 1)
ape::plot.phylo(abqr001_ClustalW_dml_upgma, main = "ClustalW -> dist.ml -> upgma", use.edge.length = FALSE, cex = 1)
```
 
```{r fig.height=10, fig.keep='all', fig.show='hold'}
drake::loadd(c("abqr001_Muscle_dml_upgma", "abqr001_ClustalO_dml_upgma", "abqr001_ClustalW_dml_upgma"))

treespace::plotTreeDiff(tr1 = abqr001_Muscle_dml_upgma,
                       tr2 = abqr001_ClustalO_dml_upgma,
                       use.edge.length = FALSE,
                       treesFacing = TRUE,
                       colourMethod = "palette",
                       palette = adegenet::funky,
                       tipMatch = FALSE) # defaults to TRUE; disable when using ladderized treesD

treespace::plotTreeDiff(tr1 = abqr001_ClustalW_dml_upgma,
                       tr2 = abqr001_ClustalO_dml_upgma,
                       use.edge.length = FALSE,
                       treesFacing = TRUE,
                       colourMethod = "palette",
                       palette = adegenet::funky,
                       tipMatch = FALSE) # defaults to TRUE; disable when using ladderized trees
```

```{r fig.height=15, fig.width=12}
drake::loadd(trees)
phangorn::densiTree(trees,
                   type = "cladogram",
                   scaleX = T,
                   # jitter = list(amount = 0.05, random = FALSE),
                   alpha = 0.5,
                   col = c("red", "green", "blue"),
                   use.edge.length = FALSE
                   )
```


## Heatmap
#```{r}
#drake::loadd(abqr_001_trspc)
#adegraphics::table.image(abqr_001_trspc$D)
#```